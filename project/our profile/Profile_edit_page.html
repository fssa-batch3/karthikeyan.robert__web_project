<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="../assets/css/edit_profile.css">
    <title>Edit Profile</title>
</head>
<header class="profile_head">

    <a href="../Main_page.html"> <img src="../assets/images/logo.png" alt="image" class="logo" /> </a>
    <div class="search_input_logo">
        <input class="search_box" placeholder="Search Campaigns & Petitions"></input>
        <button class="search_button"><img src="../assets/images/search_logo.png" alt="image"
                class="search_logo" /></button>
    </div>
    <div class="profile_logo">

        <div id="user_name" class="profile_name">
            KARTHIKEYAN
        </div>
        <a href="../our profile/our_profile.html">
            <div class="logo_profile">
                <img src="../assets/images/user.png" alt="image" class="user_logo" />
            </div>
        </a>

    </div>


</header>

<body>
    <section>
        <div class="container">
            <h1>Profile</h1>
            <hr>
            <div class="row">
                <!-- left column -->
                <div class="col-md-3">
                    <div class="text-center">
                        <img src="//placehold.it/100" class="avatar img-circle" alt="avatar">
                        <h6>Upload a different photo...</h6>

                        <input type="file" class="form-control">
                    </div>
                </div>

                <!-- edit form column -->
                <div class="col-md-9 personal-info">
                    <div class="alert alert-info alert-dismissable">

                        <h3>Personal info</h3>

                        <form class="form-horizontal" role="form">
                            <div class="form-group">
                                <label class="col-lg-3 control-label">Full name:</label>
                                <div class="col-lg-8">
                                    <input class="form-control" type="text" id="name" readonly>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="col-lg-3 control-label">Email:</label>
                                <div class="col-lg-8">
                                    <input class="form-control" type="text" id="email" readonly>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="col-md-3 control-label">Mobile Number:</label>
                                <div class="col-md-8">
                                    <input class="form-control" type="number" id="number" readonly>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="col-md-3 control-label"></label>
                                <div class="col-md-8">
                                    <input type="button" class="btn-primary" value="Edit">
                                    <input type="button" class="btn-secondary" value="submit">
                                    <span></span>
                                    <input type="reset" class="btn-teritary" value="delete">
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <hr>

    </section>

    <section class="footer_section2">
        <div class="copyrights">
            <b> KN FUNDING is a Registered Trademark. Â© 2022 KN FUNDING. All Rights Reserved. Made by karthikeyan with
                ðŸ’— </b>
        </div>
    </section>



    <script>
        let userId = JSON.parse(localStorage.getItem('userId'));
        let user_list = JSON.parse(localStorage.getItem("user_list"));

        function login_data(e) {
            return e.number == userId;
        }
        user_data = user_list.find(login_data);

        document.getElementById("name").value = user_data['name'];
        document.getElementById("email").value = user_data['email'];
        document.getElementById("number").value = user_data['number'];

        const sumbit = document.querySelector(".btn-primary");
        sumbit.addEventListener("click", findReadonly1)

        const save = document.querySelector(".btn-secondary")
        save.addEventListener("click", saveUpdate)

        function findReadonly(e) {
            document.getElementById("name").removeAttribute("readonly");
            document.getElementById("email").removeAttribute("readonly");

        }
        function findReadonly1(e) {
            document.getElementById("name").setAttribute("readonly", "true");
            document.getElementById("email").setAttribute("readonly", "true");
        }
        const editThing = document.querySelector(".btn-primary");
        editThing.addEventListener("click", findReadonly);

        function saveUpdate(e) {

            e.preventDefault();
            let user_name = document.getElementById("name").value
            let user_number = document.getElementById("number").value
            let user_email = document.getElementById("email").value


            user_data["name"] = user_name;
            user_data["number"] = user_number;
            user_data["email"] = user_email;


            localStorage.setItem('user_list', JSON.stringify(user_list));
            alert("Updated successfully");
            // window.location.href = "../Myprofile/6_profile.html"
            // console.log(user_list);
        }

        const dataDelete = document.querySelector(".btn-teritary");
        dataDelete.addEventListener("click", delData)
        function delData(e) {
            if (confirm("Are you sure?")) {
                let userId = JSON.parse(localStorage.getItem("userId"));
                let user_list = JSON.parse(localStorage.getItem("user_list"));
                
                function login_data(e) {
                    return e.number == userId;
                }

                user_data = user_list.find(login_data);

                const indexOfUser = user_list.indexOf(user_data);

                user_list.splice(indexOfUser, 1);
                localStorage.setItem('user_list', JSON.stringify(user_list));
                // window.location.href = "../../index.html";
            };
        }
    </script>

</body>

</html>